language: python

matrix:
  include:
    - os: osx
      language: generic
      env: TRAVIS_PYTHON_VERSION=2.7

    - os: osx
      language: generic
      env: TRAVIS_PYTHON_VERSION=3.6
 
    - os: linux
      dist: trusty
      env: TRAVIS_PYTHON_VERSION=2.7

    - os: linux
      dist: trusty
      env: TRAVIS_PYTHON_VERSION=3.6

cache:
  directories:
    - $HOME/condacache/pkgs
    - $HOME/.cache/pip

install:
  # Use Astropy ci helpers for initial setup
  - git clone git://github.com/astropy/ci-helpers.git
  - source ci-helpers/travis/setup_conda_$TRAVIS_OS_NAME.sh
  - source activate test
  # Install dependencies. This include test and lint dependencies
  - conda update -n root conda -q --no-pin
  - conda config --add pkgs_dirs ~/condacache/pkgs
  - conda install -n test pytest six -q --no-pin
  # Install swmm from latest develop packages
  - conda install -n test libswmm -c owa-q --no-pin
  - if [ "${TRAVIS_PYTHON_VERSION}" = "2.7" ]; then
        - conda install -n test enum34 -q --no-pin
    fi
  # Install this package
  - python setup.py develop

script:
  - py.test pyswmm
